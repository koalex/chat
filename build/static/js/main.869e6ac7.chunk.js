(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{126:function(e,t){},129:function(e,t,a){"use strict";a.r(t);var n,c=a(0),o=a.n(c),r=a(8),s=a.n(r),i=(a(93),a(73)),l=a.n(i),u=a(23),m=a(28),f=a(15),g=a(77),b=a(11),_=a(170),p=a(172),d="@@CHAT/FETCH_USERS_SUCCESS",E="@@CHAT/USER_JOIN",h="@@CHAT/USER_LEFT",j="@@CHAT/FETCH_MESSAGES",O="@@CHAT/FETCH_MESSAGES_SUCCESS",v="@@CHAT/NEW_MESSAGE",S=Object(p.a)(d),C=Object(p.a)(E),w=Object(p.a)(h),A=Object(p.a)(j),H=Object(p.a)(O),k=Object(p.a)(v),x=Object(m.b)({chat:Object(_.a)((n={},Object(f.a)(n,S,(function(e,t){var a=t.payload.users;return Object(b.a)(Object(b.a)({},e),{},{users:a})})),Object(f.a)(n,C,(function(e){return Object(b.a)(Object(b.a)({},e),{},{users:e.users+1})})),Object(f.a)(n,w,(function(e){return e.users?Object(b.a)(Object(b.a)({},e),{},{users:e.users-1}):e})),Object(f.a)(n,A,(function(e){return Object(b.a)(Object(b.a)({},e),{},{loading:!0})})),Object(f.a)(n,H,(function(e,t){var a=t.payload.messages;return Object(b.a)(Object(b.a)({},e),{},{messages:a})})),Object(f.a)(n,k,(function(e,t){var a=t.payload.message;return Object(b.a)(Object(b.a)({},e),{},{messages:[].concat(Object(g.a)(e.messages),[a]).sort((function(e,t){return e.created_at>t.created_at}))})})),n),{users:0,messages:[],loading:!1})}),y=function(e,t){return x(e,t)},M=a(38),N=a.n(M),T=a(161),F=a(165),D=a(75),U=a.n(D),R=function(){var e=Object(u.c)((function(e){return e.chat.users}));return o.a.createElement(T.a,{position:"fixed"},o.a.createElement(F.a,{className:N.a.toolbar},o.a.createElement("div",{className:N.a.logoContainer},o.a.createElement("img",{src:U.a,alt:"Group chat",className:N.a.logo}),e," users"),o.a.createElement("a",{className:N.a["App-link"],href:"https://github.com/koalex/chat",target:"_blank",rel:"noopener noreferrer"},o.a.createElement("svg",{className:"octicon octicon-mark-github v-align-middle",height:"32",viewBox:"0 0 16 16",version:"1.1",width:"32","aria-hidden":"true"},o.a.createElement("path",{fillRule:"evenodd",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})))))},G=a(25),I=a.n(G),L=a(78),Y=a(76)("http://localhost:3000",{transports:["websocket"],forceNew:!1,rejectUnauthorized:!0,secure:!1});var J=function(){var e=Object(c.useState)(null),t=Object(L.a)(e,2),a=t[0],n=t[1];return Object(c.useEffect)((function(){Y.on("connect",(function(){console.info("socket connected"),n(Y)}))}),[]),Object(c.useEffect)((function(){a&&(a.on("connect_error",console.error),a.on("error",console.error),a.on("disconnect",(function(e){["io server disconnect"].some((function(t){return t===e}))&&a.open()})),a.on("reconnect_attempt",(function(e){e>5&&(a.io.opts.transports=["polling","websocket"])})))}),[a]),a},W=a(166),z=a(167),B=a(171),K=a(130),Z=a(169),$=a(168),q=function(e){var t=new Date,a=new Date(e),n=((0).toString()+a.getDate()).slice(-2),c=((0).toString()+(a.getMonth()+1)).slice(-2),o=((0).toString()+(a.getHours()+1)).slice(-2),r=((0).toString()+(a.getMinutes()+1)).slice(-2);return t.getFullYear()===a.getFullYear()&&t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()?"".concat(o,":").concat(r):"".concat(n,".").concat(c,".").concat(a.getFullYear()," ").concat(o,":").concat(r)},P=function(){var e=Object(u.b)(),t=J(),a=Object(u.c)((function(e){return e.chat.messages})),n=Object(c.useRef)(null);Object(c.useEffect)((function(){window.scroll(0,document.body.offsetHeight)}),[a]),Object(c.useEffect)((function(){t&&t.connected&&(t.emit("users count"),t.on("users count",(function(t){e(S({users:t}))})),t.on("user joined",(function(){e(C())})),t.on("user left",(function(){e(w())})),t.on("new message",(function(t){t.self&&(n.current.value=""),e(k({message:t}))})))}),[t,e]);var r=function(e){e.preventDefault();var a=n.current.value.trim();a&&t.emit("new message",a)};return o.a.createElement("div",{className:I.a.container},o.a.createElement(W.a,{className:I.a.messagesList},a.map((function(e){return o.a.createElement(K.a,{key:e.text+e.created_at,elevation:3,className:"".concat(I.a.message," ").concat(e.self?I.a.selfMessage:"")},o.a.createElement(z.a,{alignItems:"flex-start"},o.a.createElement(B.a,{primary:e.text,secondary:q(e.created_at)})))}))),o.a.createElement("form",{action:"#",onSubmit:r,className:I.a.form},o.a.createElement(Z.a,{autoFocus:!0,label:"Enter - \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c | Shift + Enter - \u043f\u0435\u0440\u0435\u043d\u043e\u0441 \u0441\u0442\u0440\u043e\u043a\u0438",onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||r(e)},inputRef:n,multiline:!0,rows:4,variant:"outlined",className:I.a.textarea}),o.a.createElement($.a,{color:"primary",variant:"contained",type:"submit"},"Send")))},Q=Object(m.c)(y);var V=function(){return o.a.createElement(u.a,{store:Q},o.a.createElement("div",{className:l.a.App},o.a.createElement(R,null),o.a.createElement(P,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},25:function(e,t,a){e.exports={container:"Chat_container__19YMI",messagesList:"Chat_messagesList__3U_fs",form:"Chat_form__2t4T1",message:"Chat_message__1mr6p",selfMessage:"Chat_selfMessage__WKnFI",textarea:"Chat_textarea__1tMm5"}},38:function(e,t,a){e.exports={toolbar:"Header_toolbar__1EGzY",logoContainer:"Header_logoContainer__gaEZM",logo:"Header_logo__3_SJs","App-link":"Header_App-link__2byH-"}},73:function(e,t,a){e.exports={App:"App_App__16ZpL"}},75:function(e,t,a){e.exports=a.p+"static/media/logo1x1.4228d395.png"},88:function(e,t,a){e.exports=a(129)},93:function(e,t,a){}},[[88,1,2]]]);
//# sourceMappingURL=main.869e6ac7.chunk.js.map